{"version":3,"sources":["../../src/statics/scroll-to-animation.ts"],"names":[],"mappings":"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","file":"scroll-to-animation.js","sourceRoot":"","sourcesContent":["import { ReplaySubject } from 'rxjs/ReplaySubject';\r\nimport { Observable } from 'rxjs/Observable';\r\n\r\nimport { EASING } from '../statics/scroll-to-helpers';\r\nimport { ScrollToConfig } from '../models/scroll-to-config.model';\r\nimport { ScrollToListenerTarget } from '../models/scroll-to-targets.model';\r\n\r\nexport class ScrollToAnimation {\r\n\r\n\tprivate _tick: number;\r\n\tprivate _interval: any;\r\n\tprivate _time_lapsed: number;\r\n\tprivate _percentage: number;\r\n\tprivate _position: number;\r\n\tprivate _start_position: number;\r\n\tprivate _distance: number;\r\n\tprivate _source$: ReplaySubject<number>;\r\n\tprivate _windowScrollTop: number;\r\n\r\n\tconstructor(\r\n\t\tprivate _container: HTMLElement,\r\n\t\tprivate _listenerTarget: ScrollToListenerTarget,\r\n\t\tprivate readonly _is_window: boolean,\r\n\t\tprivate readonly _to: number,\r\n\t\tprivate readonly _options: ScrollToConfig,\r\n\t\tprivate _is_browser: boolean\r\n\t) {\r\n\t\tthis._tick = 16;\r\n\t\tthis._interval = null;\r\n\t\tthis._time_lapsed = 0;\r\n\r\n\t\tthis._windowScrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;\r\n\t\tthis._start_position = this._is_window ? this._windowScrollTop : this._container.scrollTop;\r\n\r\n\t\t// Correction for Starting Position of nested HTML Elements\r\n\t\tif (!this._is_window) this._to = this._to - this._container.getBoundingClientRect().top + this._start_position;\r\n\r\n\t\t// Set Distance\r\n\t\tthis._distance = Math.abs(this._start_position - this._to);\r\n\t\tlet offset = this._options.offset;\r\n\r\n\t\t// Set offset from Offset Map\r\n\t\tif (this._is_browser) {\r\n\r\n\t\t\tthis._options\r\n\t\t\t\t.offsetMap\r\n\t\t\t\t.forEach((value, key) => offset = window.innerWidth > key ? value : offset);\r\n\t\t}\r\n\r\n\t\tthis._distance += offset;\r\n\t\tthis._source$ = new ReplaySubject();\r\n\t}\r\n\r\n\t/**\r\n\t * Start the new Scroll Animation.\r\n\t *\r\n\t * @todo consider using enums for actiontypes\r\n\t *\r\n\t * @returns void\r\n\t */\r\n\tpublic start(): Observable<any> {\r\n\t\tclearInterval(this._interval);\r\n\t\tthis._interval = setInterval(this._loop, this._tick);\r\n\t\treturn this._source$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Recursively loop over the Scroll Animation.\r\n\t *\r\n\t * @returns void\r\n\t */\r\n\tprivate _loop = (): void => {\r\n\t\tthis._time_lapsed += this._tick;\r\n\t\tthis._percentage = (this._time_lapsed / this._options.duration);\r\n\t\tthis._percentage = (this._percentage > 1) ? 1 : this._percentage;\r\n\t\tthis._position = this._start_position\r\n\t\t\t+ ((this._start_position - this._to < 0 ? 1 : -1) * this._distance * EASING[this._options.easing](this._percentage));\r\n\t\tthis._source$.next(this._position);\r\n\t\tthis._is_window ? this._listenerTarget.scrollTo(0, Math.floor(this._position)) : this._container.scrollTop = Math.floor(this._position);\r\n\t\tthis.stop(false);\r\n\t}\r\n\r\n\t/**\r\n\t * Stop the current Scroll Animation Loop.\r\n\t *\r\n\t * @param force \t\t\tForce to stop\r\n\t */\r\n\tpublic stop(force: boolean = true): void {\r\n\r\n\t\tconst curr_position = this._is_window ? this._windowScrollTop : this._container.scrollTop;\r\n\r\n\t\tif (force || this._position === (this._to + this._options.offset) || curr_position === (this._to + this._options.offset)) {\r\n\t\t\tclearInterval(this._interval);\r\n\t\t\tthis._interval = null;\r\n\t\t\tthis._source$.complete();\r\n\t\t}\r\n\t}\r\n}\r\n"]}